<Window x:Class="leituraWPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Organizador de Arquivos - One Engenharia"
        Width="1200" Height="720"
        MinWidth="900" MinHeight="600"
        WindowStartupLocation="CenterScreen"
        Background="#f4f7fa">

    <!-- ——— Recursos ——— -->
    <Window.Resources>

        <!-- Cartão Principal -->
        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="#FAFAFE"/>
            <Setter Property="CornerRadius" Value="16"/>
            <Setter Property="Padding" Value="28,24"/>
            <Setter Property="Margin" Value="20,12"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#223c5c" Opacity="0.08" BlurRadius="24" ShadowDepth="3"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Cartão Secundário -->
        <Style x:Key="SecondaryCardStyle" TargetType="Border">
            <Setter Property="Background" Value="#ffffff"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="20,18"/>
            <Setter Property="Margin" Value="0,8"/>
            <Setter Property="BorderBrush" Value="#E8F1FB"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#223c5c" Opacity="0.04" BlurRadius="12" ShadowDepth="1"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Template Base para Botões -->
        <ControlTemplate x:Key="ModernButtonTemplate" TargetType="Button">
            <Border Background="{TemplateBinding Background}"
                    CornerRadius="8"
                    Padding="{TemplateBinding Padding}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}">
                <Grid>
                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    <Border x:Name="HighlightBorder" CornerRadius="8" 
                            Background="White" Opacity="0"/>
                </Grid>
            </Border>
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Trigger.EnterActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetName="HighlightBorder"
                                               Storyboard.TargetProperty="Opacity"
                                               To="0.15" Duration="0:0:0.2"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.EnterActions>
                    <Trigger.ExitActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetName="HighlightBorder"
                                               Storyboard.TargetProperty="Opacity"
                                               To="0" Duration="0:0:0.2"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.ExitActions>
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>

        <!-- Botão Primário -->
        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Template" Value="{StaticResource ModernButtonTemplate}"/>
            <Setter Property="Background" Value="#007ACC"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Margin" Value="0,0,12,0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="MinWidth" Value="120"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#0585db"/>
                    <Setter Property="Effect">
                        <Setter.Value>
                            <DropShadowEffect Color="#007acc" BlurRadius="16" ShadowDepth="2" Opacity="0.25"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#005a99"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Botão Sucesso -->
        <Style x:Key="SuccessButton" TargetType="Button" BasedOn="{StaticResource PrimaryButton}">
            <Setter Property="Background" Value="#48bc46"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#5dd65b"/>
                    <Setter Property="Effect">
                        <Setter.Value>
                            <DropShadowEffect Color="#48bc46" BlurRadius="16" ShadowDepth="2" Opacity="0.25"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#3a9938"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Botão Secundário -->
        <Style x:Key="SecondaryButton" TargetType="Button" BasedOn="{StaticResource PrimaryButton}">
            <Setter Property="Background" Value="#6c757d"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#868e96"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#5a6268"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Botão Perigo -->
        <Style x:Key="DangerButton" TargetType="Button" BasedOn="{StaticResource PrimaryButton}">
            <Setter Property="Background" Value="#F34C4C"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#ff6b6b"/>
                    <Setter Property="Effect">
                        <Setter.Value>
                            <DropShadowEffect Color="#F34C4C" BlurRadius="16" ShadowDepth="2" Opacity="0.25"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#dc3545"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- TextBox Simples e Funcional -->
        <Style x:Key="ModernTextBox" TargetType="TextBox">
            <Setter Property="Background" Value="#ffffff"/>
            <Setter Property="Foreground" Value="#212529"/>
            <Setter Property="BorderBrush" Value="#87CEEB"/>
            <Setter Property="BorderThickness" Value="0,0,0,2"/>
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="FontSize" Value="15"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Style.Triggers>
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="BorderBrush" Value="#007ACC"/>
                    <Setter Property="Effect">
                        <Setter.Value>
                            <DropShadowEffect Color="#007ACC" BlurRadius="6" ShadowDepth="0" Opacity="0.4"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="BorderBrush" Value="#5DADE2"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Style específico para TextBox com cantos arredondados -->
        <!-- TextBox com cantos arredondados (template seguro) -->
        <Style x:Key="RoundedTextBox" TargetType="TextBox" BasedOn="{StaticResource ModernTextBox}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="Bd"
                Background="{TemplateBinding Background}"
                BorderBrush="{TemplateBinding BorderBrush}"
                BorderThickness="{TemplateBinding BorderThickness}"
                CornerRadius="8"
                SnapsToDevicePixels="True">
                            <!-- PART_ContentHost sem binds exóticos -->
                            <ScrollViewer x:Name="PART_ContentHost"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="Bd" Property="Opacity" Value="0.56"/>
                            </Trigger>
                            <Trigger Property="IsKeyboardFocused" Value="True">
                                <Setter TargetName="Bd" Property="BorderBrush" Value="#007ACC"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>


        <!-- ComboBox Simples e Funcional -->
        <Style x:Key="ModernComboBox" TargetType="ComboBox">
            <Setter Property="Background" Value="#ffffff"/>
            <Setter Property="Foreground" Value="#212529"/>
            <Setter Property="BorderBrush" Value="#87CEEB"/>
            <Setter Property="BorderThickness" Value="0,0,0,2"/>
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="FontSize" Value="15"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Style.Triggers>
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="BorderBrush" Value="#007ACC"/>
                    <Setter Property="Effect">
                        <Setter.Value>
                            <DropShadowEffect Color="#007ACC" BlurRadius="6" ShadowDepth="0" Opacity="0.4"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="BorderBrush" Value="#5DADE2"/>
                </Trigger>
            </Style.Triggers>
            <Style.Resources>
                <Style TargetType="ComboBoxItem">
                    <Setter Property="Foreground" Value="#212529"/>
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="Padding" Value="8,6"/>
                    <Setter Property="FontSize" Value="15"/>
                    <Style.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="#E3F2FD"/>
                        </Trigger>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Background" Value="#BBDEFB"/>
                            <Setter Property="Foreground" Value="#007ACC"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Style.Resources>
        </Style>

        <!-- ComboBox com cantos arredondados -->
        <Style x:Key="RoundedComboBox" TargetType="ComboBox" BasedOn="{StaticResource ModernComboBox}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <ToggleButton Name="ToggleButton"
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        Focusable="false"
                                        IsChecked="{Binding Path=IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                        ClickMode="Press">
                                <ToggleButton.Template>
                                    <ControlTemplate TargetType="ToggleButton">
                                        <Border Background="{TemplateBinding Background}"
                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                CornerRadius="8">
                                            <Grid>
                                                <Path Data="M 0 0 L 4 4 L 8 0 Z" 
                                                      Fill="#495057" 
                                                      HorizontalAlignment="Right" 
                                                      VerticalAlignment="Center"
                                                      Margin="0,0,12,0"/>
                                            </Grid>
                                        </Border>
                                    </ControlTemplate>
                                </ToggleButton.Template>
                            </ToggleButton>
                            <ContentPresenter Name="ContentSite"
                                            IsHitTestVisible="False"
                                            Content="{TemplateBinding SelectionBoxItem}"
                                            ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                            ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                            Margin="12,0,30,0"
                                            VerticalAlignment="Center"
                                            HorizontalAlignment="Left"/>
                            <Popup Name="Popup"
                                 Placement="Bottom"
                                 IsOpen="{TemplateBinding IsDropDownOpen}"
                                 AllowsTransparency="True"
                                 Focusable="False"
                                 PopupAnimation="Slide">
                                <Grid Name="DropDown"
                                    SnapsToDevicePixels="True"
                                    MinWidth="{TemplateBinding ActualWidth}"
                                    MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                    <Border Name="DropDownBorder"
                                          Background="#ffffff"
                                          BorderThickness="2"
                                          BorderBrush="#87CEEB"
                                          CornerRadius="8"
                                          Margin="0,2,0,0">
                                        <ScrollViewer Margin="4,6,4,6" SnapsToDevicePixels="True">
                                            <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained"/>
                                        </ScrollViewer>
                                    </Border>
                                </Grid>
                            </Popup>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter TargetName="ToggleButton" Property="BorderBrush" Value="#007ACC"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="ToggleButton" Property="BorderBrush" Value="#5DADE2"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Headers do DataGrid -->
        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#f8f9fa"/>
            <Setter Property="Foreground" Value="#343a40"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="Padding" Value="16,12"/>
            <Setter Property="BorderBrush" Value="#dee2e6"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
        </Style>

        <!-- Estilo das linhas do log -->
        <Style x:Key="LogRowStyle" TargetType="DataGridRow">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="#212529"/>
            <Setter Property="MinHeight" Value="32"/>
            <Setter Property="FontSize" Value="13"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding Tipo}" Value="INFO">
                    <Setter Property="Foreground" Value="#28a745"/>
                    <Setter Property="Background" Value="#f8fff9"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Tipo}" Value="WARN">
                    <Setter Property="Foreground" Value="#ffc107"/>
                    <Setter Property="Background" Value="#fffef5"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Tipo}" Value="ERROR">
                    <Setter Property="Foreground" Value="#dc3545"/>
                    <Setter Property="Background" Value="#fff5f5"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Tipo}" Value="CRITICAL">
                    <Setter Property="Foreground" Value="#dc3545"/>
                    <Setter Property="FontWeight" Value="Bold"/>
                    <Setter Property="Background" Value="#fff0f0"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- Células centralizadas e selecionáveis -->
        <Style x:Key="CellCenterSelectable" TargetType="TextBox">
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="#212529"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="IsReadOnly" Value="True"/>
            <Setter Property="Padding" Value="8,4"/>
        </Style>

        <!-- Progress Bar Moderno -->
        <Style x:Key="ModernProgressBar" TargetType="ProgressBar">
            <Setter Property="Height" Value="6"/>
            <Setter Property="Background" Value="#e9ecef"/>
            <Setter Property="Foreground" Value="#007ACC"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ProgressBar">
                        <Border Background="{TemplateBinding Background}" CornerRadius="3">
                            <Grid>
                                <Rectangle Name="PART_Track" Fill="{TemplateBinding Background}" RadiusX="3" RadiusY="3"/>
                                <Rectangle Name="PART_Indicator" Fill="{TemplateBinding Foreground}" 
                                         HorizontalAlignment="Left" RadiusX="3" RadiusY="3"/>
                            </Grid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Label de Seção -->
        <Style x:Key="SectionLabel" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#343a40"/>
            <Setter Property="Margin" Value="0,0,0,16"/>
        </Style>

        <!-- Label de Campo -->
        <Style x:Key="FieldLabel" TargetType="TextBlock">
            <Setter Property="FontSize" Value="15"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#343a40"/>
            <Setter Property="Margin" Value="0,0,0,8"/>
        </Style>

        <!-- Status Badge -->
        <Style x:Key="StatusBadge" TargetType="Border">
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="12,4"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="Background" Value="#e9ecef"/>
        </Style>
    </Window.Resources>

    <!-- ——— Layout Principal ——— -->
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="280"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- ——— Painel Lateral ——— -->
        <Border Grid.Row="0" Grid.Column="0" Grid.RowSpan="2"
                CornerRadius="0,16,16,0" Padding="24">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                    <GradientStop Color="#007ACC" Offset="0"/>
                    <GradientStop Color="#0585db" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Header do Painel -->
                <StackPanel Grid.Row="0" HorizontalAlignment="Center" Margin="0,0,0,32">
                    <Border Background="White" CornerRadius="50" Width="64" Height="64" 
                            HorizontalAlignment="Center" Margin="0,0,0,16">
                        <Path Data="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M17,13H13V17H11V13H7V11H11V7H13V11H17V13Z" 
                              Fill="#007ACC" Width="32" Height="32" Stretch="Uniform" 
                              HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                    <TextBlock Text="Organizador" FontWeight="Bold" FontSize="18" 
                               Foreground="White" TextAlignment="Center"/>
                    <TextBlock Text="de Arquivos" FontWeight="Bold" FontSize="18" 
                               Foreground="White" TextAlignment="Center" Margin="0,-2,0,0"/>
                    <TextBlock Text="One Engenharia LTDA" FontSize="12" 
                               Foreground="#B8E0F8" TextAlignment="Center" Margin="0,8,0,0"/>
                </StackPanel>

                <!-- Menu/Navegação (se necessário) -->
                <StackPanel Grid.Row="1" VerticalAlignment="Top">
                    <!-- Aqui você pode adicionar itens de menu se necessário -->
                </StackPanel>

                <!-- Footer do Painel -->
                <StackPanel Grid.Row="2" VerticalAlignment="Bottom">
                    <Separator Background="#4da3db" Margin="0,0,0,16" Height="1"/>

                    <StackPanel Margin="0,0,0,16">
                        <TextBlock Text="Suporte Técnico" FontWeight="SemiBold" FontSize="12" 
                                   Foreground="White" Margin="0,0,0,4"/>
                        <TextBlock Text="suporte@oneengenharia.com" 
                                   Foreground="#B8E0F8" FontSize="11" TextWrapping="Wrap"/>

                        <TextBlock x:Name="LblVersao"
                                   Foreground="#B8E0F8" FontSize="10" FontStyle="Italic"
                                   Margin="0,8,0,0"/>
                    </StackPanel>

                    <StackPanel>
                        <TextBlock Text="© 2025 One Engenharia" 
                                   Foreground="#B8E0F8" FontSize="10" 
                                   TextAlignment="Center"/>
                        <TextBlock x:Name="LblUsuario" Text="Usuário Conectado"
                                   Foreground="White" FontSize="11" FontStyle="Italic" 
                                   TextAlignment="Center" Margin="0,4,0,0"/>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ——— Conteúdo Principal ——— -->
        <ScrollViewer Grid.Row="0" Grid.Column="1" VerticalScrollBarVisibility="Auto" 
                      HorizontalScrollBarVisibility="Disabled" Padding="0,0,8,0">
            <StackPanel Margin="0,0,0,20">

                <!-- ——— Seção de Configuração ——— -->
                <Border Style="{StaticResource CardStyle}">
                    <StackPanel>
                        <TextBlock Text="Configuração do Processamento" Style="{StaticResource SectionLabel}"/>

                        <!-- Pasta de Origem -->
                        <Grid Margin="0,0,0,24">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" Margin="0,0,16,0">
                                <TextBlock Text="Pasta de Origem" Style="{StaticResource FieldLabel}"/>
                                <TextBox x:Name="txtOrigem" Style="{StaticResource RoundedTextBox}"
                                         Height="42" IsReadOnly="True"
                                         Text="Selecione uma pasta..." VerticalContentAlignment="Center"/>
                            </StackPanel>

                            <Button x:Name="btnSelecionarOrigem" Grid.Column="1" 
                                    Content="📁 Selecionar" Style="{StaticResource PrimaryButton}"
                                    Height="42" Width="140" Margin="0,23,0,0"
                                    Click="btnSelecionarOrigem_Click"/>
                        </Grid>

                        <!-- Linha com OS e UF -->
                        <Grid Margin="0,0,0,24">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- Número da OS -->
                            <StackPanel Grid.Column="0" Margin="0,0,20,0">
                                <TextBlock Text="Número da Ordem de Serviço" Style="{StaticResource FieldLabel}"/>
                                <TextBox x:Name="txtNumos" Style="{StaticResource RoundedTextBox}"
                                         Height="42" FontSize="16" FontWeight="SemiBold" 
                                         VerticalContentAlignment="Center"/>
                            </StackPanel>

                            <!-- UF -->
                            <StackPanel Grid.Column="1" Margin="0,0,20,0">
                                <TextBlock Text="Estado (UF)" Style="{StaticResource FieldLabel}"/>
                                <ComboBox x:Name="cboUf" Style="{StaticResource RoundedComboBox}"
                                          Height="42" SelectedIndex="0" VerticalContentAlignment="Center">
                                    <ComboBoxItem Content="AC - Acre"/>
                                    <ComboBoxItem Content="MT - Mato Grosso"/>
                                </ComboBox>
                            </StackPanel>

                            <!-- Botão Processar -->
                            <Button x:Name="btnProcessar" Grid.Column="2" 
                                    Content="⚡ Processar" Style="{StaticResource SuccessButton}"
                                    Height="42" Width="140" Margin="0,23,0,0" FontSize="15"
                                    Click="btnProcessar_Click" IsDefault="True"/>
                        </Grid>

                        <!-- Status e Progresso -->
                        <Border Style="{StaticResource SecondaryCardStyle}" Margin="0,8,0,0">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,12">
                                    <Border x:Name="StatusBadge" Style="{StaticResource StatusBadge}" Background="#d1ecf1">
                                        <TextBlock Text="🔄 Aguardando" FontSize="12" Foreground="#0c5460" FontWeight="Medium"/>
                                    </Border>
                                    <Button x:Name="btnAbrirPasta" Content="📂 Abrir Destino" 
                                            Style="{StaticResource SecondaryButton}" Height="32"
                                            Margin="16,0,0,0" Visibility="Collapsed"
                                            Click="btnAbrirPasta_Click"/>
                                </StackPanel>

                                <ProgressBar x:Name="progress" Grid.Row="1" 
                                           Style="{StaticResource ModernProgressBar}"
                                           Visibility="Collapsed" Value="0"/>
                            </Grid>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- ——— Seção de Log ——— -->
                <Border Style="{StaticResource CardStyle}">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock Text="📋 Registro de Operações" Style="{StaticResource SectionLabel}" Margin="0"/>
                            <Border Background="#f8f9fa" CornerRadius="8" Padding="8,4" Margin="16,0,0,0" VerticalAlignment="Center">
                                <TextBlock x:Name="LogCount" Text="0 registros" FontSize="11" Foreground="#6c757d"/>
                            </Border>
                        </StackPanel>

                        <Border Background="#ffffff" CornerRadius="12" BorderBrush="#e9ecef" BorderThickness="1">
                            <DataGrid x:Name="GridLog" AutoGenerateColumns="False" IsReadOnly="True"
                                      RowStyle="{StaticResource LogRowStyle}" GridLinesVisibility="None"
                                      HeadersVisibility="Column" ScrollViewer.VerticalScrollBarVisibility="Auto"
                                      CanUserResizeRows="False" MinHeight="250" MaxHeight="400"
                                      Background="Transparent" BorderThickness="0">
                                <DataGrid.Columns>
                                    <DataGridTemplateColumn Header="⏰ Horário" Width="120">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBox Text="{Binding Hora, StringFormat=HH:mm:ss}" 
                                                         Style="{StaticResource CellCenterSelectable}"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTemplateColumn Header="📊 Tipo" Width="100">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBox Text="{Binding Tipo}" 
                                                         Style="{StaticResource CellCenterSelectable}" 
                                                         FontWeight="Medium"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTemplateColumn Header="" Width="50">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBox Text="{Binding Emoji}" 
                                                         Style="{StaticResource CellCenterSelectable}" 
                                                         FontSize="16"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTemplateColumn Header="💬 Mensagem" Width="*">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBox Text="{Binding Mensagem}" 
                                                         Style="{StaticResource CellCenterSelectable}"
                                                         TextAlignment="Left" FontSize="13"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Border>

                        <!-- TextBox oculto para compatibilidade -->
                        <TextBox x:Name="txtLog" Visibility="Collapsed"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <!-- ——— Barra de Status/Ações ——— -->
        <Border Grid.Row="1" Grid.Column="1" Background="#ffffff" 
                BorderBrush="#e9ecef" BorderThickness="0,1,0,0"
                Padding="24,16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Lado Esquerdo - Sincronização -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <Button x:Name="btnExecutar" Content="🔄 Sincronizar e Enviar Backup"
                            Style="{StaticResource PrimaryButton}" Height="40" Width="220"
                            Click="btnExecutar_Click"/>

                    <StackPanel Orientation="Vertical" Margin="20,0,0,0">
                        <TextBlock x:Name="txtStatus" Text="Pronto" FontWeight="SemiBold" 
                                   FontSize="13" Foreground="#28a745"/>
                        <TextBlock x:Name="txtResumo" Text="Sistema inicializado" 
                                   FontSize="12" Foreground="#6c757d"/>
                    </StackPanel>
                </StackPanel>

                <!-- Lado Direito - Upload/Backup -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <StackPanel Orientation="Vertical" Margin="0,0,20,0" HorizontalAlignment="Right">
                        <TextBlock x:Name="TxtSyncStatus" Text="Backup sincronizado"
                                   FontWeight="SemiBold" FontSize="13" Foreground="#6c757d"
                                   TextAlignment="Right"/>
                        <TextBlock x:Name="TxtLastUpdate" Text="Última atualização: --"
                                   FontSize="12" Foreground="#adb5bd" TextAlignment="Right"/>
                    </StackPanel>

                    <ProgressBar x:Name="UploadBar" Style="{StaticResource ModernProgressBar}"
                                 Width="100" Margin="0,0,0,0" Visibility="Collapsed"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>